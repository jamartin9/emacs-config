<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>tor</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="org-default.css" />
</head>
<body>
<div id="content" class="container content">
<div id="outline-container-orge7bbe9d" class="outline-2">
<h2 id="orge7bbe9d">tor</h2>
<div class="outline-text-2" id="text-orge7bbe9d">
</div>
<div id="outline-container-org22b7d5e" class="outline-3">
<h3 id="org22b7d5e">tor notes</h3>
<div class="outline-text-3" id="text-org22b7d5e">
<ul class="org-ul">
<li>socks5 on 9050 by default</li>
<li>browser bundle runs 9051 by default</li>
<li>brave4u7jddbv7cyviptqjc7jusxh72uik7zt6adtckl5f4nwy2v72qd.onion is brave</li>
<li><a href="https://protonmailrmez3lotccipshtkleegetolb73fuirgj7r4o4vfu7ozyd/">https://protonmailrmez3lotccipshtkleegetolb73fuirgj7r4o4vfu7ozyd/</a> is protonmail</li>
<li><a href="https://dns4torpnlfs2ifuz2s2yf3fc7rdmsbhm6rw75euj35pac6ap25zgqad.onion/">https://dns4torpnlfs2ifuz2s2yf3fc7rdmsbhm6rw75euj35pac6ap25zgqad.onion/</a> is cloudflare 1.1.1.1</li>
<li>MapAddress palladium.libera.chat libera75jm6of4wxpxt4aynol3xjmbtxgfyjpu34ss4d7r7q2v5zrpyd.onion is liberia.chat</li>
<li>phobosxilamwcg75xt22id7aywkzol6q6rfl2flipcqoc4e4ahima5id.onion is phobos</li>
<li>xmh57jrknzkhv6y3ls3ubitzfqnkrwxhopf5aygthi7d6rplyvk3noyd.onion is torch</li>
<li>monerotoruzizulg5ttgat2emf4d6fbmiea25detrmmy7erypseyteyd.onion is getmonero (unstoppableswap.net for btc-&gt;xmr)</li>
<li>p2pmin25k4ei5bp3l6bpyoap6ogevrc35c3hcfue7zfetjpbhhshxdqd.onion is p2pool</li>
<li>njallalafimoej5i4eg7vlnqjvmb6zhdh27qxcatdn647jtwwwui3nad.onion is njal
<ul class="org-ul">
<li>pozzed and will remove dns/vps it they do not like your content</li>
</ul></li>
<li><a href="https://incoghostm2dytlqdiaj3lmtn7x2l5gb76jhabb6ywbqhjfzcoqq6aad.onion/">https://incoghostm2dytlqdiaj3lmtn7x2l5gb76jhabb6ywbqhjfzcoqq6aad.onion/</a> is incognet</li>
<li><a href="https://uquusqsaaad66cvub4473csdu4uu7ahxou3zqc35fpw5d4ificedzyqd.onion/">https://uquusqsaaad66cvub4473csdu4uu7ahxou3zqc35fpw5d4ificedzyqd.onion/</a> is kiwifarms</li>
<li>uzfomcxbx24d3esy7akpdbiovcfoorupz4aez6fpabmyh45nnqdp7mqd.onion is /fdroid/repo</li>
<li><a href="https://4zwzi66wwdaalbhgnix55ea3ab4pvvw66ll2ow53kjub6se4q2bclcyd.onion">https://4zwzi66wwdaalbhgnix55ea3ab4pvvw66ll2ow53kjub6se4q2bclcyd.onion</a> is guix sub mirror</li>
<li>archiveiya74codqgiixo33q62qlrqtkgmcitqx5u2oeqnmn5bpcbiyd.onion is archive.is</li>
<li>dreadytofatroptsdj6io7l3xptbet6onoyno2yv7jicoxknyazubrad.onion/ is dread</li>
<li><a href="https://twitter3e4tixl4xyajtrzo62zg5vztmjuricljdp2c5kshju4avyoid.onion/">https://twitter3e4tixl4xyajtrzo62zg5vztmjuricljdp2c5kshju4avyoid.onion/</a> is twitter</li>
<li><a href="https://5gdvpfoh6kb2iqbizb37lzk2ddzrwa47m6rpdueg2m656fovmbhoptqd.onion/">https://5gdvpfoh6kb2iqbizb37lzk2ddzrwa47m6rpdueg2m656fovmbhoptqd.onion/</a> is riseup</li>
<li><a href="http://zlibrary24tuxziyiyfr7zd46ytefdqbqd2axkmxm4o5374ptpc52fad.onion/">http://zlibrary24tuxziyiyfr7zd46ytefdqbqd2axkmxm4o5374ptpc52fad.onion/</a> is zlib
<ul class="org-ul">
<li><a href="https://bookszlibb74ugqojhzhg2a63w5i2atv5bqarulgczawnbmsb6s6qead.onion/">https://bookszlibb74ugqojhzhg2a63w5i2atv5bqarulgczawnbmsb6s6qead.onion/</a> - zlib books</li>
</ul></li>
<li>digicert offers ev wildcard certs for .onion and harica.gr offers .onion</li>
<li>ensure multi point check or pinned HTTPS verified to avoid bgp att</li>
<li>tcp 9001 for relay default without bridge</li>
<li>set <code>DNSPort 127.0.10.1:53</code> and set pihole uservice directory of client/service</li>
<li>tcp with outbound nat punching</li>
<li>Traffic analysis vulnerabilities excluding routing/ddos fingerprinting
<ul class="org-ul">
<li>snowflake (webrtc)
<ul class="org-ul">
<li>hardcoded STUN servers list with fast local DNS requests for multiple instead of 1</li>
<li>hardcoded request to sstatic cdn for domain fronting after STUN</li>
</ul></li>
<li>client unvalidated TLS handshake to node
<ul class="org-ul">
<li>server TLS cert is self signed</li>
<li>hardcodes fields in specific order, unusual lack of additional data fields</li>
<li>issuer CN is always www. (8-20 chars) .com with no country, state, org or issuer</li>
<li>subject CN is always www. (8-20 chars) .net (non overlaping with issuer) with no fields</li>
</ul></li>
<li>obsf4
<ul class="org-ul">
<li>well known protocols are not imitated throughly ie the first data packet on port 443 needs a TLS/SSL header to be HTTPS</li>
<li>obsf4proxy sets TCP push flag on last packet (uncommon)</li>
<li>initialization data is half duplex and only flows one way at a time</li>
<li>first data packet is client to server packet is 141 - 8192 bytes and the next server to client packet is 21 - 8192 bytes</li>
<li>all data is  21 - 8192 bytes, checking 6+ data packets for size range increases fingerprint</li>
<li>identified connections can reveal others based on the half second timing window for parallel connections</li>
<li>Inter Arrival Timing flags
<ul class="org-ul">
<li>0 sends largest first with last having psh flag due to network segmentation</li>
<li>1 sets the max payload to 1448 bytes (with psh flag)</li>
<li>2 uncommon uses random sizes and the psh flag doesn't always change direction of data flow</li>
</ul></li>
</ul></li>
<li>Browser bundle
<ul class="org-ul">
<li>automatic bridge connections on startup</li>
<li>known bridge request changing traceability</li>
<li>private bridges allow unique tracking and proof as bridges persist to disk</li>
</ul></li>
</ul></li>
<li><a href="https://github.com/cathugger/mkp224o">vanity address generator for v3</a>
<ul class="org-ul">
<li>v3 addresses use ed25519 keys</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org37ae9cf" class="outline-3">
<h3 id="org37ae9cf">Link .torrc</h3>
<div class="outline-text-3" id="text-org37ae9cf">
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org1cd5bc6">(ignore-errors
  (let* ((tor-confdir (concat (file-name-as-directory (if (getenv "XDG_CONFIG_HOME")
							  (getenv "XDG_CONFIG_HOME")
							(concat (file-name-as-directory (getenv "HOME"))
								".config")))
			      "tor"))
	(tor-conf (concat (file-name-as-directory tor-confdir) ".torrc")))
    (if (not (file-exists-p tor-confdir))
	(progn (make-directory tor-confdir)
	       (set-file-modes tor-confdir #o700)))
    (if (not (or (file-exists-p tor-conf) (file-symlink-p tor-conf)))
	(make-symbolic-link (concat (file-name-directory (or load-file-name buffer-file-name)) ".torrc") tor-conf 1))))
</pre>
</div>
</div>
</div>
<div id="outline-container-orge3ce39d" class="outline-3">
<h3 id="orge3ce39d">Data Directory</h3>
<div class="outline-text-3" id="text-orge3ce39d">
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orgdeacf8b">(concat (if (getenv "XDG_CONFIG_HOME")
	    (file-name-as-directory (getenv "XDG_CONFIG_HOME"))
	  (file-name-as-directory (concat (file-name-as-directory (getenv "HOME")) ".config")))
	"tor")
</pre>
</div>
</div>
</div>
<div id="outline-container-org599090a" class="outline-3">
<h3 id="org599090a">Control Socket</h3>
<div class="outline-text-3" id="text-org599090a">
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org1a9903e">(concat (file-name-as-directory
	 (concat (if (getenv "XDG_CONFIG_HOME")
		     (file-name-as-directory (getenv "XDG_CONFIG_HOME"))
		   (file-name-as-directory (concat (file-name-as-directory (getenv "HOME")) ".config")))
		 "tor"))
	"torSocket")
</pre>
</div>
</div>
</div>
<div id="outline-container-org19d03ca" class="outline-3">
<h3 id="org19d03ca">.torrc</h3>
<div class="outline-text-3" id="text-org19d03ca">
<div class="org-src-container">
<pre class="src src-conf" id="orgcfa6728">StrictNodes 1
AvoidDiskWrites 1
#UseBridges 1

# does not work with bridges
EntryNodes {us}

#ExcludeExitNodes {il},{gb},{ca},{nz},{au},{us},{fr},{??}
#ExcludeNodes BadExit,Unnamed,default,{il},{gb},{ca},{nz},{au}

#ExitNodes {us}

# obfs4proxy configuration
#ClientTransportPlugin obfs2,obfs3,obfs4,scramblesuit exec /usr/share/tor/PluggableTransports/obfs4proxy


DataDirectory /home/jam/.config/tor
ControlSocket /home/jam/.config/tor/torSocket
CookieAuthentication 1

#HiddenServiceDir /Library/Tor/var/lib/tor/hidden_service/
#HiddenServicePort 80 unix:/path/to/socket
</pre>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
